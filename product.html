<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Страница товара</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; background-color: #fcfcfc; min-height: 100vh; }
.header-bg { background-color: #ffffff; box-shadow: 0 1px 3px rgba(0,0,0,0.05);}
.orange-accent { background-color: #f97316; color:white; font-weight:700; transition:0.3s; }
.orange-accent:hover { background-color: #ea580c; }
.option-button-style { border:2px solid #f97316; background:#ffedd5; color:#f97316; font-weight:600; transition:0.2s; }
.option-button-style.active { background:#f97316; color:white; box-shadow:0 2px 5px rgba(249,115,22,0.3);}
.thumbnail { width:60px; height:60px; border:2px solid transparent; cursor:pointer; border-radius:0.5rem; transition:0.2s; }
.thumbnail.active { border-color:#f97316; box-shadow:0 2px 5px rgba(249,115,22,0.3);}
</style>
</head>
<body class="pb-20">

<header class="sticky top-0 header-bg z-20">
  <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
    <a href="#" class="text-3xl font-black text-gray-900 tracking-tight">Nolikby</a>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 mt-6">

  <div class="mb-6 text-sm text-gray-500">
    <a href="#" class="hover:text-orange-500 transition">Главная</a>
    <span class="mx-2">/</span>
    <a href="#" class="hover:text-orange-500 transition" id="product-category">Категория</a>
    <span class="mx-2">/</span>
    <span class="text-gray-900 font-medium" id="product-title">Товар</span>
  </div>

  <div class="lg:grid lg:grid-cols-2 lg:gap-10">

    <!-- Галерея -->
    <div class="mb-8 lg:mb-0">
      <div id="thumbnail-gallery" class="flex gap-3 mb-3"></div>
      <img id="main-image" src="" class="w-full rounded-3xl mb-3">
    </div>

    <!-- Информация о товаре -->
    <div class="p-6 bg-white rounded-3xl shadow-2xl">
      <h1 class="text-4xl font-black text-gray-900 mb-2" id="product-title">Товар</h1>
      <p class="text-lg font-medium text-orange-600 uppercase mb-4" id="product-category">Категория</p>

      <!-- Фасады -->
      <div class="mb-5">
        <p class="font-bold text-gray-800 mb-3">Фасад:</p>
        <div class="flex flex-wrap gap-3" id="facade-options"></div>
      </div>

      <!-- Цвета -->
      <div class="mb-8">
        <p class="font-bold text-gray-800 mb-3">Цвет/Текстура:</p>
        <div class="flex flex-wrap gap-3" id="color-options"></div>
      </div>

      <!-- Кнопка купить -->
      <div class="flex flex-col space-y-4">
        <button id="buy-button" class="orange-accent text-white font-black text-lg py-4 rounded-xl uppercase">
          Купить
        </button>
      </div>
    </div>

  </div>
</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

// Firebase конфиг
const firebaseConfig = {
  apiKey: "AIzaSyA-LeQHKV4NfJrTKQCGjG-VQGhfWxtPk70",
  authDomain: "vsemmebel-90d48.firebaseapp.com",
  projectId: "vsemmebel-90d48",
  storageBucket: "vsemmebel-90d48.appspot.com",
  messagingSenderId: "958123504041",
  appId: "1:958123504041:web:1f14f4561d6bb6628494b8"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Получаем ID из URL
const urlParams = new URLSearchParams(window.location.search);
const productId = urlParams.get("id");
if (!productId) alert("Товар не выбран!");

// Загрузка товара
async function loadProduct(id) {
  const docRef = doc(db, "products", id);
  const docSnap = await getDoc(docRef);

  if (!docSnap.exists()) { alert("Товар не найден!"); return; }
  const data = docSnap.data();

  document.getElementById("product-title").textContent = data.title;
  document.getElementById("product-category").textContent = data.category;
  document.getElementById("main-image").src = data.images[0];

  // Галерея миниатюр
  const gallery = document.getElementById("thumbnail-gallery");
  gallery.innerHTML = data.images.map((img,i) => `<img src="${img}" class="thumbnail ${i===0?'active':''}" onclick="selectThumbnail(this, '${img}')">`).join('');

  // Фасады
  const facadeContainer = document.getElementById("facade-options");
  facadeContainer.innerHTML = data.facades.map(f => `<button class="option-button-style ${f===data.facades[0]?'active':''}" type="button" onclick="selectFacade(this, '${f}')">${f}</button>`).join('');

  // Цвета
  const colorContainer = document.getElementById("color-options");
  colorContainer.innerHTML = data.colors.map(c => `<button class="option-button-style ${c.name===data.colors[0].name?'active':''}" type="button" onclick="selectColor(this, '${c.name}', '${c.image}')">${c.name}</button>`).join('');

  // Купить
  document.getElementById("buy-button").onclick = () => {
    const storesInfo = data.stores.map(s => `${s.name} - ${s.address} - ${s.phone}`).join("\n");
    alert("Где купить:\n" + storesInfo);
  };
}

// Выбор миниатюры
window.selectThumbnail = function(el, img) {
  document.getElementById("main-image").src = img;
  document.querySelectorAll(".thumbnail").forEach(t => t.classList.remove("active"));
  el.classList.add("active");
};

// Выбор фасада
window.selectFacade = function(el, facade) {
  document.querySelectorAll("#facade-options .option-button-style").forEach(b => b.classList.remove("active"));
  el.classList.add("active");
  alert("Выбран фасад: " + facade);
};

// Выбор цвета
window.selectColor = function(el, color, img) {
  document.getElementById("main-image").src = img;
  document.querySelectorAll("#color-options .option-button-style").forEach(b => b.classList.remove("active"));
  el.classList.add("active");
  alert("Выбран цвет: " + color);
};

loadProduct(productId);
</script>
</body>
</html>
